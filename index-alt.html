<!DOCTYPE html><html lang="en">  <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><canvas class="zdog-canvas" id="game"></canvas><title>BackFlipped - js13k 2019</title>
    <style>body {margin: 0;font-family: "Courier New", Courier, monospace;overflow: hidden;}html, body { width:100%; height:100%; }.zdog-canvas {display: block;width:100%; height:100%;}.title {position: absolute;pointer-events: none;text-align: center;-webkit-text-stroke-width: 2px;font-weight: 800;top: 50%;left: 50%;}.debug {position: absolute;top: 0%;background-color: #ccccccBB;font-size: 12px;}.stats {position: absolute;bottom: 5%;background-color: #ccccccBB;font-size: 12px;}.top {font-size: 70px;color: #223e32;-webkit-text-stroke-color: #ffffff;transform: translate(-125%,-190%) skewY(-10deg) ;text-shadow: -2px -5px #223e32;}.bottom {font-size: 90px;color: #A7C06D;-webkit-text-stroke-color: #000000;transform: skewY(10deg) translate(-40%,-65%);text-shadow: 2px -5px #A7C06D;}.start {font-size: 30px; width: 250px;color: #ffffff;-webkit-text-stroke-width: 0px;text-shadow: 3px -3px #000000;transform: translate(-50%,300%);animation-name: gamestart-start;animation-duration: 1s;animation-timing-function: ease-in-out;animation-iteration-count: infinite;animation-direction: alternate;}.notification {position: absolute;top: 10px; right: 10px;font-size: 16px;padding: 5px; padding-top: 10px; padding-bottom: 10px;color: white;pointer-events: none;}.notification::before {content: "";position: absolute;top: 0; bottom: 0; left: 0; right: 0;transform: skewY(3deg);border: white solid 2px;pointer-events: none;}.int {color: white;position: absolute;pointer-events: none;text-align: center;font-weight: 800;top: 0%;left: 50%;visibility: hidden;}.remaining {font-size: 30px;transform: translate(-50%,-50%);width: 250px;}.jackpot {font-size: 20px;transform: translate(25%,100%) rotate(-10deg);width: 200px;color: black;background-color: white;mix-blend-mode: screen; }.score {font-size: 20px;transform: translate(-110%,50%);width: 80px;border: 2px dotted white;}.levelselect, .colorselect {color: black;position: absolute;pointer-events: none;text-align: center;font-weight: 800;top: 50%;left: 50%;visibility: hidden;font-size: 20px;background-color: #ffffffaa;width: 180px;padding: 5px;}.levelselect {transform: translate(-50%,-140%);height: 50px;}.colorselect {transform: translate(-50%,0%);height: 150px;}@keyframes gamestart-top {from {transform: translate(-125%,-190%) skewY(-10deg) scale(1,1);opacity: 1}to {transform: translate(-125%,-190%) skewY(-10deg) scale(-1.5,1.5) rotate(20deg);opacity: 0}}@keyframes gamestart-bottom {from {transform: skewY(10deg) translate(-40%,-65%) scale(1,1);opacity: 1}to {transform: skewY(10deg) translate(-40%,-65%) scale(1.5,-1.5) rotate(-20deg);opacity: 0}}@keyframes gamestart-start {from {transform: translate(-50%,250%);}to {transform: translate(-50%,200%);}}@keyframes jackpot-gain-1 {from {transform: translate(25%,80%) rotate(-10deg);}to {transform: translate(25%,100%) rotate(-10deg);}}@keyframes jackpot-gain-2 {from {transform: translate(25%,80%) rotate(-10deg);}to {transform: translate(25%,100%) rotate(-10deg);}}@keyframes jackpot-claim-1 {0% {transform: translate(25%,100%) rotate(-10deg);}50% {transform: translate(25%,100%) rotate(-190deg);}100% {transform: translate(25%,100%) rotate(-370deg);}}@keyframes jackpot-claim-2 {0% {transform: translate(25%,100%) rotate(-10deg);}50% {transform: translate(25%,100%) rotate(-190deg);}100% {transform: translate(25%,100%) rotate(-370deg);}}@media only screen and (max-width: 600px) {.top {font-size: 50px;}.bottom {font-size: 60px;}.start {font-size: 20px;}.notification {font-size: 12px;}}@media only screen and (max-width: 359px) {.top {font-size: 30px;}.bottom {font-size: 40px;}.start {font-size: 15px;}.notification {font-size: 10px;}}</style>
    <link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAwFBMVEUhPTEiPzEiODMiOjIgPjAiNTMBxAAfRC4AuwAEvwECvQD+//4bWCcWbR8RihUJoQoEtQMDygEDxgEAwQDv9+/e993C78IlNDYhQTEePC4eOC4XaSAhxR4VcRwJfQ4Qwg0IpggEnAX3+vfp/efi9OLg/97a89nMydHA+L2467eU5JJm12MxVT49yzkmJzkkLjcyyC8eTSweSiwu1SodeCUbZSUYUiUnziMZYyMWWCEYxhURhBUSxxANkxAHrgYFrAbLU1gJAAAAuElEQVQYGQXBA4JDUQAEwZ7nb8XO2rZy/1ttFRJIMzQDkJAQxlszRQghNF+81c1+E42QQHOdX4Xw/nx4NA4hLW6KccrPRl1jQSD/cnySZeNiNZTGCSdfnx5t06R4GCovgaabi9E2TYrb4dVLyJnPr1Weri9/2midAGf2IctSyivvEHK6r/s2z/rGgwTY9V+o4nfIS+MkHHbXdcu7dR9+DQiw8WMZTdmGHSAE1nuwsXyyIAAkwBoL0j+azgviGaVrKQAAAABJRU5ErkJggg==" type="image/png"><meta name="monetization" content="$coil.xrptipbot.com/3mQNkjRsTVid5VZd6XJv4g">  </head>  <body>
    <script> !function(t,e){"object"==typeof module&&module.exports?module.exports=e():t.Zdog=e()}(this,function(){var t={};t.TAU=2*Math.PI,t.extend=function(t,e){for(var r in e)t[r]=e[r];return t},t.lerp=function(t,e,r){return(e-t)*r+t},t.modulo=function(t,e){return(t%e+e)%e};var e={2:function(t){return t*t},3:function(t){return t*t*t},4:function(t){return t*t*t*t},5:function(t){return t*t*t*t*t}};return t.easeInOut=function(t,r){if(1==r)return t;var i=(t=Math.max(0,Math.min(1,t)))<.5,o=i?t:1-t,n=(e[r]||e[2])(o/=.5);return n/=2,i?n:1-n},t}),function(t,e){"object"==typeof module&&module.exports?module.exports=e():t.Zdog.CanvasRenderer=e()}(this,function(){var t={isCanvas:!0,begin:function(t){t.beginPath()},move:function(t,e,r){t.moveTo(r.x,r.y)},line:function(t,e,r){t.lineTo(r.x,r.y)},bezier:function(t,e,r,i,o){t.bezierCurveTo(r.x,r.y,i.x,i.y,o.x,o.y)},closePath:function(t){t.closePath()},setPath:function(){},renderPath:function(e,r,i,o){this.begin(e,r),i.forEach(function(i){i.render(e,r,t)}),o&&this.closePath(e,r)},stroke:function(t,e,r,i,o){r&&(t.strokeStyle=i,t.lineWidth=o,t.stroke())},fill:function(t,e,r,i){r&&(t.fillStyle=i,t.fill())},end:function(){}};return t}),function(t,e){"object"==typeof module&&module.exports?module.exports=e():t.Zdog.SvgRenderer=e()}(this,function(){var t={isSvg:!0},e=t.round=function(t){return Math.round(1e3*t)/1e3};function r(t){return e(t.x)+","+e(t.y)+" "}return t.begin=function(){},t.move=function(t,e,i){return"M"+r(i)},t.line=function(t,e,i){return"L"+r(i)},t.bezier=function(t,e,i,o,n){return"C"+r(i)+r(o)+r(n)},t.closePath=function(){return"Z"},t.setPath=function(t,e,r){e.setAttribute("d",r)},t.renderPath=function(e,r,i,o){var n="";i.forEach(function(i){n+=i.render(e,r,t)}),o&&(n+=this.closePath(e,r)),this.setPath(e,r,n)},t.stroke=function(t,e,r,i,o){r&&(e.setAttribute("stroke",i),e.setAttribute("stroke-width",o))},t.fill=function(t,e,r,i){var o=r?i:"none";e.setAttribute("fill",o)},t.end=function(t,e){t.appendChild(e)},t}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./boilerplate"));else{var r=t.Zdog;r.Vector=e(r)}}(this,function(t){function e(t){this.set(t)}var r=t.TAU;function i(t,e,i,o){if(e&&e%r!=0){var n=Math.cos(e),s=Math.sin(e),h=t[i],a=t[o];t[i]=h*n-a*s,t[o]=a*n+h*s}}function o(t){return Math.abs(t-1)<1e-8?1:Math.sqrt(t)}return e.prototype.set=function(t){return this.x=t&&t.x||0,this.y=t&&t.y||0,this.z=t&&t.z||0,this},e.prototype.write=function(t){return t?(this.x=null!=t.x?t.x:this.x,this.y=null!=t.y?t.y:this.y,this.z=null!=t.z?t.z:this.z,this):this},e.prototype.rotate=function(t){if(t)return this.rotateZ(t.z),this.rotateY(t.y),this.rotateX(t.x),this},e.prototype.rotateZ=function(t){i(this,t,"x","y")},e.prototype.rotateX=function(t){i(this,t,"y","z")},e.prototype.rotateY=function(t){i(this,t,"x","z")},e.prototype.isSame=function(t){return!!t&&(this.x===t.x&&this.y===t.y&&this.z===t.z)},e.prototype.add=function(t){return t?(this.x+=t.x||0,this.y+=t.y||0,this.z+=t.z||0,this):this},e.prototype.subtract=function(t){return t?(this.x-=t.x||0,this.y-=t.y||0,this.z-=t.z||0,this):this},e.prototype.multiply=function(t){return null==t?this:("number"==typeof t?(this.x*=t,this.y*=t,this.z*=t):(this.x*=null!=t.x?t.x:1,this.y*=null!=t.y?t.y:1,this.z*=null!=t.z?t.z:1),this)},e.prototype.transform=function(t,e,r){return this.multiply(r),this.rotate(e),this.add(t),this},e.prototype.lerp=function(e,r){return this.x=t.lerp(this.x,e.x||0,r),this.y=t.lerp(this.y,e.y||0,r),this.z=t.lerp(this.z,e.z||0,r),this},e.prototype.magnitude=function(){return o(this.x*this.x+this.y*this.y+this.z*this.z)},e.prototype.magnitude2d=function(){return o(this.x*this.x+this.y*this.y)},e.prototype.copy=function(){return new e(this)},e}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./boilerplate"),require("./vector"),require("./canvas-renderer"),require("./svg-renderer"));else{var r=t.Zdog;r.Anchor=e(r,r.Vector,r.CanvasRenderer,r.SvgRenderer)}}(this,function(t,e,r,i){var o=t.TAU,n={x:1,y:1,z:1};function s(t){this.create(t||{})}return s.prototype.create=function(r){this.children=[],t.extend(this,this.constructor.defaults),this.setOptions(r),this.translate=new e(r.translate),this.rotate=new e(r.rotate),this.scale=new e(n).multiply(this.scale),this.origin=new e,this.renderOrigin=new e,this.addTo&&this.addTo.addChild(this)},s.defaults={},s.optionKeys=Object.keys(s.defaults).concat(["rotate","translate","scale","addTo"]),s.prototype.setOptions=function(t){var e=this.constructor.optionKeys;for(var r in t)-1!=e.indexOf(r)&&(this[r]=t[r])},s.prototype.addChild=function(t){-1==this.children.indexOf(t)&&(t.remove(),t.addTo=this,this.children.push(t))},s.prototype.removeChild=function(t){var e=this.children.indexOf(t);-1!=e&&this.children.splice(e,1)},s.prototype.remove=function(){this.addTo&&this.addTo.removeChild(this)},s.prototype.update=function(){0!=this.visible&&(this.reset(),this.children.forEach(function(t){t.update()}),this.transform(this.translate,this.rotate,this.scale))},s.prototype.reset=function(){this.renderOrigin.set(this.origin)},s.prototype.transform=function(t,e,r){this.renderOrigin.transform(t,e,r),this.children.forEach(function(i){i.transform(t,e,r)})},s.prototype.updateGraph=function(){this.update(),this.updateFlatGraph(),this.flatGraph.forEach(function(t){t.updateSortValue()}),this.flatGraph.sort(s.shapeSorter)},s.shapeSorter=function(t,e){return t.sortValue-e.sortValue},Object.defineProperty(s.prototype,"flatGraph",{get:function(){return this._flatGraph||this.updateFlatGraph(),this._flatGraph},set:function(t){this._flatGraph=t}}),s.prototype.updateFlatGraph=function(){this.flatGraph=this.getFlatGraph()},s.prototype.getFlatGraph=function(){var t=[this];return this.addChildFlatGraph(t)},s.prototype.addChildFlatGraph=function(t){return this.children.forEach(function(e){var r=e.getFlatGraph();Array.prototype.push.apply(t,r)}),t},s.prototype.updateSortValue=function(){this.sortValue=this.renderOrigin.z},s.prototype.render=function(){},s.prototype.renderGraphCanvas=function(t){if(!t)throw new Error("ctx is "+t+". Canvas context required for render. Check .renderGraphCanvas( ctx ).");this.flatGraph.forEach(function(e){e.render(t,r)})},s.prototype.renderGraphSvg=function(t){if(!t)throw new Error("svg is "+t+". SVG required for render. Check .renderGraphSvg( svg ).");this.flatGraph.forEach(function(e){e.render(t,i)})},s.prototype.copy=function(e){var r={};return this.constructor.optionKeys.forEach(function(t){r[t]=this[t]},this),t.extend(r,e),new(0,this.constructor)(r)},s.prototype.copyGraph=function(t){var e=this.copy(t);return this.children.forEach(function(t){t.copyGraph({addTo:e})}),e},s.prototype.normalizeRotate=function(){this.rotate.x=t.modulo(this.rotate.x,o),this.rotate.y=t.modulo(this.rotate.y,o),this.rotate.z=t.modulo(this.rotate.z,o)},s.subclass=function e(r){return function(i){function o(t){this.create(t||{})}return o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.defaults=t.extend({},r.defaults),t.extend(o.defaults,i),o.optionKeys=r.optionKeys.slice(0),Object.keys(o.defaults).forEach(function(t){1!=!o.optionKeys.indexOf(t)&&o.optionKeys.push(t)}),o.subclass=e(o),o}}(s),s}),function(t,e){"object"==typeof module&&module.exports?module.exports=e(t):t.Zdog.Dragger=e(t)}(this,function(t){var e="mousedown",r="mousemove",i="mouseup";function o(){}function n(t){this.create(t||{})}return t.PointerEvent?(e="pointerdown",r="pointermove",i="pointerup"):"ontouchstart"in t&&(e="touchstart",r="touchmove",i="touchend"),n.prototype.create=function(t){this.onDragStart=t.onDragStart||o,this.onDragMove=t.onDragMove||o,this.onDragEnd=t.onDragEnd||o,this.bindDrag(t.startElement)},n.prototype.bindDrag=function(t){(t=this.getQueryElement(t))&&(t.style.touchAction="none",t.addEventListener(e,this))},n.prototype.getQueryElement=function(t){return"string"==typeof t&&(t=document.querySelector(t)),t},n.prototype.handleEvent=function(t){var e=this["on"+t.type];e&&e.call(this,t)},n.prototype.onmousedown=n.prototype.onpointerdown=function(t){this.dragStart(t,t)},n.prototype.ontouchstart=function(t){this.dragStart(t,t.changedTouches[0])},n.prototype.dragStart=function(e,o){e.preventDefault(),this.dragStartX=o.pageX,this.dragStartY=o.pageY,t.addEventListener(r,this),t.addEventListener(i,this),this.onDragStart(o)},n.prototype.ontouchmove=function(t){this.dragMove(t,t.changedTouches[0])},n.prototype.onmousemove=n.prototype.onpointermove=function(t){this.dragMove(t,t)},n.prototype.dragMove=function(t,e){t.preventDefault();var r=e.pageX-this.dragStartX,i=e.pageY-this.dragStartY;this.onDragMove(e,r,i)},n.prototype.onmouseup=n.prototype.onpointerup=n.prototype.ontouchend=n.prototype.dragEnd=function(){t.removeEventListener(r,this),t.removeEventListener(i,this),this.onDragEnd()},n}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./boilerplate"),require("./anchor"),require("./dragger"));else{var r=t.Zdog;r.Illustration=e(r,r.Anchor,r.Dragger)}}(this,function(t,e,r){function i(){}var o=t.TAU,n=e.subclass({element:void 0,centered:!0,zoom:1,dragRotate:!1,resize:!1,onPrerender:i,onDragStart:i,onDragMove:i,onDragEnd:i,onResize:i});return t.extend(n.prototype,r.prototype),n.prototype.create=function(t){e.prototype.create.call(this,t),r.prototype.create.call(this,t),this.setElement(this.element),this.setDragRotate(this.dragRotate),this.setResize(this.resize)},n.prototype.setElement=function(t){if(!(t=this.getQueryElement(t)))throw new Error("Zdog.Illustration element required. Set to "+t);var e=t.nodeName.toLowerCase();"canvas"==e?this.setCanvas(t):"svg"==e&&this.setSvg(t)},n.prototype.setSize=function(t,e){t=Math.round(t),e=Math.round(e),this.isCanvas?this.setSizeCanvas(t,e):this.isSvg&&this.setSizeSvg(t,e)},n.prototype.setResize=function(t){this.resize=t,this.resizeListener||(this.resizeListener=this.onWindowResize.bind(this)),t?(window.addEventListener("resize",this.resizeListener),this.onWindowResize()):window.removeEventListener("resize",this.resizeListener)},n.prototype.onWindowResize=function(){this.setMeasuredSize(),this.onResize(this.width,this.height)},n.prototype.setMeasuredSize=function(){var t,e;if("fullscreen"==this.resize)t=window.innerWidth,e=window.innerHeight;else{var r=this.element.getBoundingClientRect();t=r.width,e=r.height}this.setSize(t,e)},n.prototype.renderGraph=function(t){this.isCanvas?this.renderGraphCanvas(t):this.isSvg&&this.renderGraphSvg(t)},n.prototype.updateRenderGraph=function(t){this.updateGraph(),this.renderGraph(t)},n.prototype.setCanvas=function(t){this.element=t,this.isCanvas=!0,this.ctx=this.element.getContext("2d"),this.setSizeCanvas(t.width,t.height)},n.prototype.setSizeCanvas=function(t,e){this.width=t,this.height=e;var r=this.pixelRatio=window.devicePixelRatio||1;this.element.width=this.canvasWidth=t*r,this.element.height=this.canvasHeight=e*r,r>1&&!this.resize&&(this.element.style.width=t+"px",this.element.style.height=e+"px")},n.prototype.renderGraphCanvas=function(t){t=t||this,this.prerenderCanvas(),e.prototype.renderGraphCanvas.call(t,this.ctx),this.postrenderCanvas()},n.prototype.prerenderCanvas=function(){var t=this.ctx;if(t.lineCap="round",t.lineJoin="round",t.clearRect(0,0,this.canvasWidth,this.canvasHeight),t.save(),this.centered){var e=this.width/2*this.pixelRatio,r=this.height/2*this.pixelRatio;t.translate(e,r)}var i=this.pixelRatio*this.zoom;t.scale(i,i),this.onPrerender(t)},n.prototype.postrenderCanvas=function(){this.ctx.restore()},n.prototype.setSvg=function(t){this.element=t,this.isSvg=!0,this.pixelRatio=1;var e=t.getAttribute("width"),r=t.getAttribute("height");this.setSizeSvg(e,r)},n.prototype.setSizeSvg=function(t,e){this.width=t,this.height=e;var r=t/this.zoom,i=e/this.zoom,o=this.centered?-r/2:0,n=this.centered?-i/2:0;this.element.setAttribute("viewBox",o+" "+n+" "+r+" "+i),this.resize?(this.element.removeAttribute("width"),this.element.removeAttribute("height")):(this.element.setAttribute("width",t),this.element.setAttribute("height",e))},n.prototype.renderGraphSvg=function(t){t=t||this,function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(this.element),this.onPrerender(this.element),e.prototype.renderGraphSvg.call(t,this.element)},n.prototype.setDragRotate=function(t){t&&(!0===t&&(t=this),this.dragRotate=t,this.bindDrag(this.element))},n.prototype.dragStart=function(){this.dragStartRX=this.dragRotate.rotate.x,this.dragStartRY=this.dragRotate.rotate.y,r.prototype.dragStart.apply(this,arguments)},n.prototype.dragMove=function(t,e){var i=e.pageX-this.dragStartX,n=e.pageY-this.dragStartY,s=Math.min(this.width,this.height),h=i/s*o,a=n/s*o;this.dragRotate.rotate.x=this.dragStartRX-a,this.dragRotate.rotate.y=this.dragStartRY-h,r.prototype.dragMove.apply(this,arguments)},n}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./vector"));else{var r=t.Zdog;r.PathCommand=e(r.Vector)}}(this,function(t){function e(e,o,n){this.method=e,this.points=o.map(r),this.renderPoints=o.map(i),this.previousPoint=n,this.endRenderPoint=this.renderPoints[this.renderPoints.length-1],"arc"==e&&(this.controlPoints=[new t,new t])}function r(e){return e instanceof t?e:new t(e)}function i(e){return new t(e)}e.prototype.reset=function(){var t=this.points;this.renderPoints.forEach(function(e,r){var i=t[r];e.set(i)})},e.prototype.transform=function(t,e,r){this.renderPoints.forEach(function(i){i.transform(t,e,r)})},e.prototype.render=function(t,e,r){return this[this.method](t,e,r)},e.prototype.move=function(t,e,r){return r.move(t,e,this.renderPoints[0])},e.prototype.line=function(t,e,r){return r.line(t,e,this.renderPoints[0])},e.prototype.bezier=function(t,e,r){var i=this.renderPoints[0],o=this.renderPoints[1],n=this.renderPoints[2];return r.bezier(t,e,i,o,n)};return e.prototype.arc=function(t,e,r){var i=this.previousPoint,o=this.renderPoints[0],n=this.renderPoints[1],s=this.controlPoints[0],h=this.controlPoints[1];return s.set(i).lerp(o,9/16),h.set(n).lerp(o,9/16),r.bezier(t,e,s,h,n)},e}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./boilerplate"),require("./vector"),require("./path-command"),require("./anchor"));else{var r=t.Zdog;r.Shape=e(r,r.Vector,r.PathCommand,r.Anchor)}}(this,function(t,e,r,i){var o=i.subclass({stroke:1,fill:!1,color:"#333",closed:!0,visible:!0,path:[{}],front:{z:1},backface:!0});o.prototype.create=function(t){i.prototype.create.call(this,t),this.updatePath(),this.front=new e(t.front||this.front),this.renderFront=new e(this.front),this.renderNormal=new e};var n=["move","line","bezier","arc"];o.prototype.updatePath=function(){this.setPath(),this.updatePathCommands()},o.prototype.setPath=function(){},o.prototype.updatePathCommands=function(){var t;this.pathCommands=this.path.map(function(e,i){var o=Object.keys(e),s=o[0],h=e[s];1==o.length&&-1!=n.indexOf(s)||(s="line",h=e);var a="line"==s||"move"==s,p=Array.isArray(h);a&&!p&&(h=[h]);var u=new r(s=0===i?"move":s,h,t);return t=u.endRenderPoint,u})},o.prototype.reset=function(){this.renderOrigin.set(this.origin),this.renderFront.set(this.front),this.pathCommands.forEach(function(t){t.reset()})},o.prototype.transform=function(t,e,r){this.renderOrigin.transform(t,e,r),this.renderFront.transform(t,e,r),this.renderNormal.set(this.renderOrigin).subtract(this.renderFront),this.pathCommands.forEach(function(i){i.transform(t,e,r)}),this.children.forEach(function(i){i.transform(t,e,r)})},o.prototype.updateSortValue=function(){var t=this.pathCommands.length,e=this.pathCommands[0].endRenderPoint,r=this.pathCommands[t-1].endRenderPoint;t>2&&e.isSame(r)&&(t-=1);for(var i=0,o=0;o<t;o++)i+=this.pathCommands[o].endRenderPoint.z;this.sortValue=i/t},o.prototype.render=function(t,e){var r=this.pathCommands.length;if(this.visible&&r&&(this.isFacingBack=this.renderNormal.z>0,this.backface||!this.isFacingBack)){if(!e)throw new Error("Zdog renderer required. Set to "+e);var i=1==r;e.isCanvas&&i?this.renderCanvasDot(t,e):this.renderPath(t,e)}};var s=t.TAU;o.prototype.renderCanvasDot=function(t){var e=this.getLineWidth();if(e){t.fillStyle=this.getRenderColor();var r=this.pathCommands[0].endRenderPoint;t.beginPath();var i=e/2;t.arc(r.x,r.y,i,0,s),t.fill()}},o.prototype.getLineWidth=function(){return this.stroke?1==this.stroke?1:this.stroke:0},o.prototype.getRenderColor=function(){return"string"==typeof this.backface&&this.isFacingBack?this.backface:this.color},o.prototype.renderPath=function(t,e){var r=this.getRenderElement(t,e),i=!(2==this.pathCommands.length&&"line"==this.pathCommands[1].method)&&this.closed,o=this.getRenderColor();e.renderPath(t,r,this.pathCommands,i),e.stroke(t,r,this.stroke,o,this.getLineWidth()),e.fill(t,r,this.fill,o),e.end(t,r)};return o.prototype.getRenderElement=function(t,e){if(e.isSvg)return this.svgElement||(this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","path"),this.svgElement.setAttribute("stroke-linecap","round"),this.svgElement.setAttribute("stroke-linejoin","round")),this.svgElement},o}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./anchor"));else{var r=t.Zdog;r.Group=e(r.Anchor)}}(this,function(t){var e=t.subclass({updateSort:!1,visible:!0});return e.prototype.updateSortValue=function(){var e=0;this.flatGraph.forEach(function(t){t.updateSortValue(),e+=t.sortValue}),this.sortValue=e/this.flatGraph.length,this.updateSort&&this.flatGraph.sort(t.shapeSorter)},e.prototype.render=function(t,e){this.visible&&this.flatGraph.forEach(function(r){r.render(t,e)})},e.prototype.updateFlatGraph=function(){this.flatGraph=this.addChildFlatGraph([])},e.prototype.getFlatGraph=function(){return[this]},e}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./shape"));else{var r=t.Zdog;r.Rect=e(r.Shape)}}(this,function(t){var e=t.subclass({width:1,height:1});return e.prototype.setPath=function(){var t=this.width/2,e=this.height/2;this.path=[{x:-t,y:-e},{x:t,y:-e},{x:t,y:e},{x:-t,y:e}]},e}),function(t,e){if("object"==typeof module&&module.exports)module.exports=e(require("./boilerplate"),require("./anchor"),require("./shape"),require("./rect"));else{var r=t.Zdog;r.Box=e(r,r.Anchor,r.Shape,r.Rect)}}(this,function(t,e,r,i){var o=i.subclass();o.prototype.copyGraph=function(){};var n=t.TAU,s=["frontFace","rearFace","leftFace","rightFace","topFace","bottomFace"],h=t.extend({},r.defaults);delete h.path,s.forEach(function(t){h[t]=!0}),t.extend(h,{width:1,height:1,depth:1,fill:!0});var a=e.subclass(h);a.prototype.create=function(t){e.prototype.create.call(this,t),this.updatePath(),this.fill=this.fill},a.prototype.updatePath=function(){s.forEach(function(t){this[t]=this[t]},this)},s.forEach(function(t){var e="_"+t;Object.defineProperty(a.prototype,t,{get:function(){return this[e]},set:function(r){this[e]=r,this.setFace(t,r)}})}),a.prototype.setFace=function(t,e){var r=t+"Rect",i=this[r];if(e){var n=this.getFaceOptions(t);n.color="string"==typeof e?e:this.color,i?i.setOptions(n):i=this[r]=new o(n),i.updatePath(),this.addChild(i)}else this.removeChild(i)},a.prototype.getFaceOptions=function(t){return{frontFace:{width:this.width,height:this.height,translate:{z:this.depth/2}},rearFace:{width:this.width,height:this.height,translate:{z:-this.depth/2},rotate:{y:n/2}},leftFace:{width:this.depth,height:this.height,translate:{x:-this.width/2},rotate:{y:-n/4}},rightFace:{width:this.depth,height:this.height,translate:{x:this.width/2},rotate:{y:n/4}},topFace:{width:this.width,height:this.depth,translate:{y:-this.height/2},rotate:{x:-n/4}},bottomFace:{width:this.width,height:this.depth,translate:{y:this.height/2},rotate:{x:n/4}}}[t]};return["color","stroke","fill","backface","front","visible"].forEach(function(t){var e="_"+t;Object.defineProperty(a.prototype,t,{get:function(){return this[e]},set:function(r){this[e]=r,s.forEach(function(e){var i=this[e+"Rect"],o="string"==typeof this[e];i&&!("color"==t&&o)&&(i[t]=r)},this)}})}),a});</script>
    
    <script>function SfxrParams(){this.setSettings=function(r){for(var a=0;a<24;a++)this[String.fromCharCode(97+a)]=r[a]||0;this.c<.01&&(this.c=.01);var t=this.b+this.c+this.e;if(t<.18){var e=.18/t;this.b*=e,this.c*=e,this.e*=e}}}function SfxrSynth(){var r,a,t,e,s,n,i,h,f,c,o,v;this._params=new SfxrParams,this.reset=function(){var r=this._params;e=100/(r.f*r.f+.001),s=100/(r.g*r.g+.001),n=1-r.h*r.h*r.h*.01,i=-r.i*r.i*r.i*1e-6,r.a||(o=.5-r.n/2,v=5e-5*-r.o),h=1+r.l*r.l*(r.l>0?-.9:10),f=0,c=1==r.m?0:(1-r.m)*(1-r.m)*2e4+32},this.totalReset=function(){this.reset();var e=this._params;return r=e.b*e.b*1e5,a=e.c*e.c*1e5,t=e.e*e.e*1e5+12,3*((r+a+t)/3|0)},this.synthWave=function(u,b){var w=this._params,m=1!=w.s||w.v,y=w.v*w.v*.1,g=1+3e-4*w.w,k=w.s*w.s*w.s*.1,S=1+1e-4*w.t,l=1!=w.s,p=w.x*w.x,d=w.g,x=w.q||w.r,A=w.r*w.r*w.r*.2,q=w.q*w.q*(w.q<0?-1020:1020),M=w.p?32+((1-w.p)*(1-w.p)*2e4|0):0,_=w.d,U=w.j/2,j=w.k*w.k*.01,C=w.a,P=r,R=1/r,W=1/a,z=1/t,B=5/(1+w.u*w.u*20)*(.01+k);B>.8&&(B=.8),B=1-B;for(var D,E,F,G,H,I,J=!1,K=0,L=0,N=0,O=0,Q=0,T=0,V=0,X=0,Y=0,Z=0,$=new Array(1024),rr=new Array(32),ar=$.length;ar--;)$[ar]=0;for(ar=rr.length;ar--;)rr[ar]=2*Math.random()-1;for(ar=0;ar<b;ar++){if(J)return ar;if(M&&++Y>=M&&(Y=0,this.reset()),c&&++f>=c&&(c=0,e*=h),(e*=n+=i)>s&&(e=s,d>0&&(J=!0)),E=e,U>0&&(Z+=j,E*=1+Math.sin(Z)*U),(E|=0)<8&&(E=8),C||((o+=v)<0?o=0:o>.5&&(o=.5)),++L>P)switch(L=0,++K){case 1:P=a;break;case 2:P=t}switch(K){case 0:N=L*R;break;case 1:N=1+2*(1-L*W)*_;break;case 2:N=1-L*z;break;case 3:N=0,J=!0}x&&((F=0|(q+=A))<0?F=-F:F>1023&&(F=1023)),m&&g&&((y*=g)<1e-5?y=1e-5:y>.1&&(y=.1)),I=0;for(var tr=8;tr--;){if(++V>=E&&(V%=E,3==C))for(var er=rr.length;er--;)rr[er]=2*Math.random()-1;switch(C){case 0:H=V/E<o?.5:-.5;break;case 1:H=1-V/E*2;break;case 2:H=.225*(((H=1.27323954*(G=6.28318531*((G=V/E)>.5?G-1:G))+.405284735*G*G*(G<0?1:-1))<0?-1:1)*H*H-H)+H;break;case 3:H=rr[Math.abs(32*V/E|0)]}m&&(D=T,(k*=S)<0?k=0:k>.1&&(k=.1),l?(Q+=(H-T)*k,Q*=B):(T=H,Q=0),O+=(T+=Q)-D,H=O*=1-y),x&&($[X%1024]=H,H+=$[(X-F+1024)%1024],X++),I+=H}I*=.125*N*p,u[ar]=I>=1?32767:I<=-1?-32768:32767*I|0}return b}}var synth=new SfxrSynth;window.jsfxr=function(r){synth._params.setSettings(r);var a=synth.totalReset(),t=new Uint8Array(4*((a+1)/2|0)+44),e=2*synth.synthWave(new Uint16Array(t.buffer,44),a),s=new Uint32Array(t.buffer,0,44);s[0]=1179011410,s[1]=e+36,s[2]=1163280727,s[3]=544501094,s[4]=16,s[5]=65537,s[6]=44100,s[7]=88200,s[8]=1048578,s[9]=1635017060,s[10]=e,e+=44;for(var n=0,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="data:audio/wav;base64,";n<e;n+=3){var f=t[n]<<16|t[n+1]<<8|t[n+2];h+=i[f>>18]+i[f>>12&63]+i[f>>6&63]+i[63&f]}return h};</script>
    
    <script>x=game.getContext`2d`;const TAU=Zdog.TAU,c_startverticalspeed=1,c_addverticalspeed=1;c_fallspeed=3,c_dropspeed=5;const c_adddropspeed=.025,c_jumpspeed=5,c_addjumpspeed=.1,c_starttime=60,c_startjackpot=5,c_timegainperblock=.2,c_horborder=200,c_yflipmargin=60;inputbuffer="",inputtime=0,state=0,paused=!1,canstartgame=!1,playermovex=0,playermovey=1,flipped=1,flipvisual=1,flipy=9e3,fliptop=0,flipbottom=0,cameray=0,shakex=0,shakey=0,shakeduration=0,obstacle=[],visobstacle=[],dots=[],timeleft=c_starttime,timejackpot=c_startjackpot,score=0,hiscore=0,activated=0,activategoal=0,level=5;const times=[];let fps;seed=200,lasttimestamp=performance.now(),palette=0,palletename="",c=[],c[0]="#223e32",c[1]="#A7C06D",c[2]="#b3dd52",c[3]="#015d00",c[4]="#04bf00",c[5]="#ffffff",palettename="Default Colors",bgcolor=c[0],document.addEventListener("DOMContentLoaded",HtmlLoaded),initGame(),switchPalette(palette),setInterval(e=>{step(!1)},1/60*1e3),onkeydown=(e=>{"ArrowLeft"!=e.key&&"ArrowRight"!=e.key&&" "!=e.key&&"Backspace"!=e.key||e.preventDefault(),input(e.key)});let pageWidth=window.innerWidth||document.body.clientWidth,treshold=10,touchstartX=0,touchstartY=0,touchendX=0,touchendY=0;const limit=Math.tan(.375*Math.PI),gestureZone=document.getElementById("game");function initGame(){illo=new Zdog.Illustration({element:".zdog-canvas",dragRotate:!1,zoom:2,resize:!0,rotate:{x:-TAU/16,y:TAU/16},onPrerender:function(e){e.beginPath(),e.rect(-1080,-1080,2160,2160),e.fillStyle=bgcolor,e.fill()}}),player=new Zdog.Group({addTo:illo,transform:{z:25}}),head=new Zdog.Shape({addTo:player,stroke:24,color:c[4]}),eyes=new Zdog.Shape({addTo:player,stroke:5,color:"#fff",translate:{z:5},path:[{x:-6,y:-10},{x:-6,y:0},{move:{x:6,y:-10}},{x:6,y:0}]}),legs=new Zdog.Shape({addTo:player,stroke:5,color:c[4],translate:{y:16,z:5},path:[{x:-6,y:-10},{x:-6,y:0},{x:-10,y:0},{move:{x:6,y:-10}},{x:6,y:0},{x:10,y:0}]}),border=new Zdog.Shape({addTo:illo,stroke:8,color:c[1],path:[{x:-c_horborder-10,y:-700},{x:-c_horborder-10,y:700},{move:{x:c_horborder+10,y:-700}},{x:c_horborder+10,y:700}]}),flipline=new Zdog.Shape({addTo:illo,stroke:8,color:c[1],translate:{z:25},path:[{x:1*-c_horborder},{x:.9*-c_horborder},{move:{x:.8*-c_horborder}},{x:.7*-c_horborder},{move:{x:.6*-c_horborder}},{x:.5*-c_horborder},{move:{x:.4*-c_horborder}},{x:.3*-c_horborder},{move:{x:.2*-c_horborder}},{x:.1*-c_horborder},{move:{x:0}},{x:.1*c_horborder},{move:{x:.2*c_horborder}},{x:.3*c_horborder},{move:{x:.4*c_horborder}},{x:.5*c_horborder},{move:{x:.6*c_horborder}},{x:.7*c_horborder},{move:{x:.8*c_horborder}},{x:.9*c_horborder},{move:{x:c_horborder}},{x:1.1*c_horborder}]}),dotanchor=new Zdog.Group({addTo:border});for(var e=0;100!=e;e+=1){var t=Math.round(10*random())/10,l="bb";t>4&&(l="88"),t>7&&(l="44"),dots[e]=new Zdog.Shape({addTo:dotanchor,translate:{x:2e3*random()-1e3,y:1e3*random(),z:1e3*random()},stroke:10*t,color:c[4]+l})}trail=new Zdog.Shape({addTo:illo,stroke:15,color:c[5]+"44",closed:!1,translate:{z:-200}}),checkCookie(),resizeScreen(),loadLevel(),draw()}function loadLevel(){if(obstacle.length>1)for(var e=0;e!=obstacle.length;e++)obstacle[e].remove(),obstacle[e]=void 0;0==state||2==state?(player.visible=!1,trail.visible=!1):(player.visible=!0,trail.visible=!0,i1.style.visibility="visible",i2.style.visibility="visible",i3.style.visibility="visible"),border.color=c[1],flipline.color=c[1],trail.translate.z=-200,11==level?seed=1e6*Math.random()+1e4:seed=1e3*level,c_fallspeed=3,c_dropspeed=5,obstacle.length=0,visobstacle.length=0,trail.path.length=0,flipped=1,flipvisual=1,bgcolor=c[0],player.translate.x=0,player.translate.y=-50,playermovex=0,1==state?playermovey=c_fallspeed:playermovey=c_fallspeed/2;var t=0;11==level?(timeleft=c_starttime,timejackpot=c_startjackpot,score=0,t=10):(t=1+4*level,timeleft=12+8*level),illo.rotate={x:-TAU/16,y:TAU/16},flipy=generateObstacles(t,100,flipped)+c_yflipmargin,11!=level&&(activated=0,activategoal=Math.round(obstacle.length*(1.6+.08*level))),flipline.translate.y=flipy,fliptop=0,flipbottom=flipy}function generateObstacles(e,t,l){for(var a=t,o=0;o!=e;o++){var r=Math.round(10*random());-1==r&&(r=Math.round(10*random()));var i=0,s=0,n=0,c=0,d=random()>=.1;switch(-1==flipped&&(d=!d),r){case 0:s=40+Math.round(10*random())/10*100,n=.5*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a,obstacle[obstacle.length]=addObstacle(n+.5*c_horborder,c,40,s,d),obstacle[obstacle.length]=addObstacle(-n-.5*c_horborder,c,40,s,d);break;case 1:s=40+Math.round(10*random())/10*100,n=.7*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a,obstacle[obstacle.length]=addObstacle(n,c,40,s,d),c+=50*l,obstacle[obstacle.length]=addObstacle(-n,c,40,s,d),a+=50*l;break;case 2:n=.8*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a,s=30,obstacle[obstacle.length]=addObstacle(n,c,64,s,d),c+=50*l,obstacle[obstacle.length]=addObstacle(n,c,24,s,d),a+=80*l;break;case 3:s=80,n=.25*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a,obstacle[obstacle.length]=addObstacle(n-.4*c_horborder,c,24,s,d),obstacle[obstacle.length]=addObstacle(n,c,24,s,d),obstacle[obstacle.length]=addObstacle(n+.4*c_horborder,c,24,s,d),a+=50*l;break;case 4:s=40+Math.round(10*random())/10*100,n=.25*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a,obstacle[obstacle.length]=addObstacle(n-.35*c_horborder,c,40,s,d),c+=50*l,obstacle[obstacle.length]=addObstacle(n,c,40,s,d),c+=50*l,obstacle[obstacle.length]=addObstacle(n+.35*c_horborder,c,40,s,d),a+=150*l;break;case 5:i=s=80+Math.round(10*random())/10*40;n=.25*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a,obstacle[obstacle.length]=addObstacle(n,c,.75*i,8,d),c+=s/2*l,obstacle[obstacle.length]=addObstacle(n-.35*c_horborder,c,16,s,d),obstacle[obstacle.length]=addObstacle(n+.35*c_horborder,c,16,s,d),c+=s/2*l,obstacle[obstacle.length]=addObstacle(n,c,.9*i,8,d),a+=100*l;break;case 6:n=.1*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a+40*l,s=16,obstacle[obstacle.length]=addObstacle(n,c,1.5*c_horborder,s,d),a+=80*l;break;default:s=40+Math.round(10*random())/10*100,n=.8*(Math.round(10*random())/10*(c_horborder- -c_horborder)-c_horborder),c=a,obstacle[obstacle.length]=addObstacle(n,c,40,s,d)}a+=(40+s)*l}return a}function addObstacle(e,t,l,a,o){var r=c[3];1==o&&(r=c[2]);var i=new Zdog.Box({addTo:illo,width:l,height:a,frontFace:!1,backFace:!1,depth:16,stroke:8,cornerRadius:20,color:r,visible:!1,translate:{x:e,y:t,z:50*o-25}});return i.zspeed=0,i}function step(e){inputtime>=2&&""!=inputbuffer&&(inputtime-=1,input(inputbuffer),1==inputtime&&(inputtime=0,inputbuffer="")),1==state&&0==paused&&(timeleft-=1/60,timeleft<=0&&gameOver());const t=performance.now();for(;times.length>0&&times[0]<=t-1e3;)times.shift();if(times.push(t),fps=times.length,document.getElementById("fps-display").innerHTML=fps.toString()+" fps",i1.innerHTML="Time: "+timeleft.toFixed(2).toString(),timeleft<10?i1.style.color="#F08080":i1.style.color="white",11==level){i2.innerHTML="All clear: +"+timejackpot.toString();var l=(player.translate.y-(fliptop-c_yflipmargin))/(flipbottom+c_yflipmargin-(fliptop-c_yflipmargin))*9.25;-1==flipped&&(l=9.45-l),l=Math.max(0,l),i3.innerHTML="Flips: "+score.toString()+"."+l.toFixed(0).toString()}else i2.innerHTML=activated.toString()+" of "+activategoal.toString(),i3.innerHTML="Level:\n"+level.toString();if(!paused||0!=e){if(shakeduration>0?(illo.translate={x:0+shakex,y:cameray+shakey},shakeduration-=1,shakeduration<=0&&(shakex="",shakey="")):illo.translate={x:0,y:cameray},0!=playermovex&&(playermovex+=c_addverticalspeed*Math.sign(playermovex)),(playermovey<=-c_dropspeed&&-1==flipped||playermovey>=c_dropspeed&&1==flipped)&&1==state&&0==playermovex?playermovey+=c_adddropspeed*Math.sign(playermovey):(1==flipped&&playermovey<1||-1==flipped&&playermovey>-1)&&0==playermovex&&(playermovey+=c_addjumpspeed*flipped),flipvisual!=flipped&&(-1==flipped?(illo.rotate.x+=TAU/64,flipvisual-=1/16):(illo.rotate.x+=TAU/64,flipvisual+=1/16)),1==flipped&&player.translate.y>flipy||-1==flipped&&player.translate.y<flipy){player.translate.y=flipy,flipped=-flipped;var a=player.translate.y;player.translate.y=0;for(var o=0;o!=obstacle.length;o+=1)obstacle[o].translate.y-=a;for(o=0;o!=trail.path.length;o+=1)trail.path[o].y-=a;if(fliptop-=a,flipbottom-=a,dotanchor.translate.y-=a,11==level&&(c_dropspeed+=.1,c_fallspeed+=.1),playermovey=flipped*c_fallspeed,0!=state&&2!=state||(playermovey=flipped*c_fallspeed*.5),11==level){score+=1;var r=!0;if(1==flipped){for(o=0;o!=obstacle.length;o+=1)if(25!=obstacle[o].translate.z){r=!1;break}flipbottom=generateObstacles(1,flipbottom-50,flipped),flipy=flipbottom+c_yflipmargin}else{for(o=0;o!=obstacle.length;o+=1)if(-25!=obstacle[o].translate.z){r=!1;break}fliptop=generateObstacles(1,fliptop+50,flipped),flipy=fliptop-c_yflipmargin}r&&("jackpot-claim-2"!=i2.style.animationName?i2.style.animation="jackpot-claim-2 1s ease-in-out":i2.style.animation="jackpot-claim-1 1s ease-in-out",timeleft+=timejackpot,sound([0,,.07,.57,.24,.75,,,,,,,,,,,,,1,,,,,.2]))}else 1==flipped?flipy=flipbottom+c_yflipmargin:flipy=fliptop-c_yflipmargin;flipline.translate.y=flipy,timejackpot=c_startjackpot,1==state&&sound([0,,,,.39,.39,,.13,,,,,,.57,,.44,,,1,,,,,.15]),-1==flipped?(bgcolor=c[1],border.color=c[0],flipline.color=c[0],trail.translate.z=200):(bgcolor=c[0],border.color=c[1],flipline.color=c[1],trail.translate.z=-200)}visobstacle.length=0;for(o=0;o!=obstacle.length;o++)0!=obstacle[o].zspeed&&(obstacle[o].translate.z>=35?(obstacle[o].translate.z=25,obstacle[o].zspeed=0):obstacle[o].translate.z<=-35?(obstacle[o].translate.z=-25,obstacle[o].zspeed=0):obstacle[o].translate.z+=5*Math.sign(obstacle[o].zspeed)),obstacle[o].translate.y>player.translate.y-700&&obstacle[o].translate.y<player.translate.y+1e3?(obstacle[o].visible=!0,visobstacle[visobstacle.length]=obstacle[o]):1==obstacle[o].visible&&(obstacle[o].visible=!1);for(var i=0;4!=i;i+=1)if(player.translate.x+=playermovex/4,player.translate.x>c_horborder&&(player.translate.x=c_horborder,playermovex=0,playermovey=1*flipped),player.translate.x<-c_horborder&&(player.translate.x=-c_horborder,playermovex=0,playermovey=1*flipped),player.translate.y+=playermovey/4,1==state)for(o=0;o!=visobstacle.length;o++)if(xx=visobstacle[o].translate.x-10*flipped,yy=visobstacle[o].translate.y+6,zz=visobstacle[o].translate.z,w=visobstacle[o].width,aw=1.2*visobstacle[o].width,h=visobstacle[o].height-4,(1==flipped&&25==zz||-1==flipped&&-25==zz)&&player.translate.x>xx-aw&&player.translate.x<xx+aw&&player.translate.y>yy-h&&player.translate.y<yy+h){var s=!1;0==playermovex?player.translate.x>xx-w&&player.translate.x<xx+w?(playermovey=c_dropspeed*flipped,shakey=2,shakeduration=2,shakex=0,shakey=10,shakeduration=3,s=!0):s=!0:player.translate.x>xx-w&&player.translate.x<xx+w&&(playermovex>0?shakex=5:playermovex<0?shakex=-5:shakex=0,playermovex=0,playermovey=c_dropspeed*flipped,shakey=0,shakeduration=2,s=!0),s&&(pushObstacleToFlipside(visobstacle[o]),sound([0,,.035,,.15+.5*random(),.49,,-.53,,,,,,.03,,,,,1,,,,,.15]))}draw()}}function pushObstacleToFlipside(e){25==e.translate.z?(e.zspeed=-10,e.translate.z+=e.zspeed,e.color=c[3]):(e.zspeed=10,e.translate.z+=e.zspeed,e.color=c[2]),11==level?timeleft+=c_timegainperblock:("jackpot-gain-2"!=i2.style.animationName?i2.style.animation="jackpot-gain-2 1s":i2.style.animation="jackpot-gain-1 1s",activated+=1,activated>=activategoal&&gameWin())}function handleGesture(e){let t=touchendX-touchstartX,l=touchendY-touchstartY,a=Math.abs(t/l),o=Math.abs(l/t);Math.abs(t)>treshold||Math.abs(l)>treshold?(o<=limit&&input(t<0?"ArrowLeft":"ArrowRight"),a<=limit&&input(l<0?"ArrowUp":"ArrowDown")):input(" ")}function input(e){if(e!=inputbuffer&&(inputbuffer=""),0==state){if(" "==e&&canstartgame)return l1.style.animation="gamestart-top 1s ease-in",l2.style.animation="gamestart-bottom 1s ease-in",not.style.visibility="hidden",sound([1,,.08,,.5,.26,,.43,,,,,,,,.68,,,1,,,,,.15]),setTimeout(function(){l1.style.visibility="hidden",l2.style.visibility="hidden"},975),void(0==hiscore?(state=1,level=1,loadLevel(level),l3.style.visibility="hidden"):(state=2,level,Math.min(hiscore,11),switchPalette(palette),updateLevelSelect()))}else if(2==state)"ArrowLeft"==e||"a"==e||"q"==e?(level-=1,0==level&&(level=1),updateLevelSelect()):"ArrowRight"==e||"d"==e?(level+=1,level==hiscore+2&&(level=hiscore+1),level>11&&(level=11),updateLevelSelect()):"ArrowUp"==e||"w"==e||"z"==e?(palette-=1,-1==palette&&(palette=6),switchPalette(palette),updateLevelSelect()):"ArrowDown"==e||"s"==e?(palette+=1,7==palette&&(palette=0),switchPalette(palette),updateLevelSelect()):" "==e&&(state=1,loadLevel(level),sound([3,,.22,.49,.4,.15,,-.39,,,,-.68,.69,,,,,,1,,,,,.25]),d.style.visibility="hidden",d3.style.visibility="hidden",d4.style.visibility="hidden",k.style.visibility="hidden",l3.style.visibility="hidden");else if(1==state){if("Escape"==e)return void pause(-1);if(paused&&"Backspace"==e&&("hidden"==l3.style.visibility?(l3.style.visibility="visible",l3.innerHTML="Confirm with [Backspace]"):(l3.style.visibility="hidden",pause(-1),gameOver()))," "==e)return void pause(!1);if(paused)return"f"==e?void step(!0):void 0;var t=0;if("ArrowLeft"!=e&&"a"!=e&&"q"!=e||(t=-1),"ArrowRight"!=e&&"d"!=e||(t=1),0!=t&&0==playermovex)return playermovex=c_startverticalspeed*t,playermovey=0,void sound([1,,.22,.26,.11,.41+.3*random(),.21,-.3,,.06,.02,,,.43,.19,,,,1,-.04,,.18,.01,.15]);if(!("ArrowUp"!=e&&"w"!=e&&"z"!=e||Math.sign(playermovey)!=flipped&&0!=Math.sign(playermovey)))return playermovex=0,playermovey=-c_jumpspeed*flipped,void sound([0,,.05,,.18,.38+.3*random(),.02,.24,.04,,.05,,,.31,.07,.06,,.08,.9,-.03,.02,.15,.03,.15]);if(("ArrowDown"==e||" "==e||"s"==e)&&(playermovey<c_dropspeed&&1==flipped||playermovey>-c_dropspeed&&-1==flipped))return playermovex=0,playermovey=c_dropspeed*flipped,void sound([1,,.25,.01,,.43+.2*random(),.27,-.25,,,,,,.79,-.66,,.2,-.18,1,,,,,.15]);0!=inputtime&&e==inputbuffer||(inputbuffer=e,inputtime=10)}}function draw(){var e=TAU/4*(1-flipvisual);-1==flipped&&(e=TAU/4*flipvisual+TAU/4*3),player.rotate={y:.08*-playermovex,x:-.15*playermovey*flipvisual+e},dotanchor.translate.y=-(player.translate.y/20+500+playermovey),border.translate.y=player.translate.y,player.visible&&trail.visible&&(trail.path[trail.path.length]={x:player.translate.x-5+10*random()-80*flipped,y:player.translate.y-2.5+5*random()+80*flipped},trail.path.length>250&&trail.path.shift(),trail.updatePath()),cameray=-flipvisual*player.translate.y*.925-100,illo.updateRenderGraph()}function gameWin(){0!=state&&2!=state&&(l1.innerHTML="Goal!",l2.innerHTML="You win",l3.innerHTML="Space/Tap for next level",level-1==hiscore&&11!=level&&(hiscore=level,level=hiscore+1,not.style.visibility="visible",10!=hiscore?(not.innerHTML="You unlocked level "+(hiscore+1).toString()+"!<br>Progress saved.",setCookie("backflipped_level",hiscore)):(not.innerHTML="You unlocked Endless mode!<br>Thanks for playing the game!",setCookie("backflipped_level",hiscore))),sound([0,,.3,,.5,.3,,.1,,.23,.4,,,.1,,,,,1,,,,,.26]),gameEnd())}function gameOver(){0!=state&&2!=state&&(l1.innerHTML="Time up",l2.innerHTML="You lose",l3.innerHTML="Space or Tap to try again",11==level&&score>hiscore&&hiscore>0&&(not.style.visibility="visible",not.innerHTML="Congrats!<br>You broke the old highscore of<br>"+hiscore.toString()+" with a new score of <b>"+score.toString()+"</b>!",hiscore=score,setCookie("backflipped_level",hiscore)),sound([3,,.18,.23,.18,.15,,-.23,,,,,,,,.58,,,1,,,,,.26]),gameEnd())}function gameEnd(){state=0,player.visible=!1,playermovey=.5*flipped,canstartgame=!1,i1.style.visibility="hidden",i2.style.visibility="hidden",i3.style.visibility="hidden",l1.style.animation="",l2.style.animation="",l1.style.visibility="visible",l2.style.visibility="visible",l1.style.color=c[0],l2.style.textShadow="-2px -5px "+c[0],l2.style.color=c[1],l2.style.textShadow="-2px -5px "+c[1],sound([0,,.021,,.28,.38,,-.4,,,,,,.12,,,,,1,,,,,.16]),setTimeout(function(){canstartgame=!0,l3.style.visibility="visible"},1e3)}function updateLevelSelect(){d.style.visibility="visible",k.style.visibility="visible",level<=10?d2.innerHTML=level.toString()+"/10":d2.innerHTML="∞ Endless",1==level?d3.style.visibility="hidden":d3.style.visibility="visible",level==hiscore+1||11==level?d4.style.visibility="hidden":d4.style.visibility="visible",k1.innerHTML="Colors ("+(palette+1).toString()+"/7)",k2.innerHTML=palettename}function random(){var e=1e4*Math.sin(seed++);return e-Math.floor(e)}function resizeScreen(){document.getElementById("game");window.innerWidth>850&&window.innerHeight>600?illo.zoom=2:window.innerWidth>600&&window.innerHeight>400?illo.zoom=1.5:window.innerWidth>400&&window.innerHeight>300?illo.zoom=1:window.innerWidth>350&&window.innerHeight>250?illo.zoom=.9:window.innerWidth>300&&window.innerHeight>200?illo.zoom=.8:illo.zoom=.7,draw()}function sound(e){var t=jsfxr(e),l=new Audio;l.src=t,l.play()}function pause(e){if(0!=state&&2!=state){if(-1==e)paused=!paused;else{if(paused==e)return;paused=e}paused?(not.style.visibility="visible",n.innerHTML="PAUSED, [Space] or [Tap] to resume<br>[Backspace] to give up",i1.style.visibility="hidden",i2.style.visibility="hidden",i3.style.visibility="hidden"):(not.style.visibility="hidden",i1.style.visibility="visible",i2.style.visibility="visible",i3.style.visibility="visible",l3.style.visibility="hidden")}}function HtmlLoaded(){l1=document.getElementById("l1"),l2=document.getElementById("l2"),l3=document.getElementById("l3"),i1=document.getElementById("i1"),i2=document.getElementById("i2"),i3=document.getElementById("i3"),d=document.getElementById("d"),d1=document.getElementById("d1"),d2=document.getElementById("d2"),d3=document.getElementById("d3"),d4=document.getElementById("d4"),k=document.getElementById("k"),k1=document.getElementById("k1"),k2=document.getElementById("k2"),k3=document.getElementById("k3"),k4=document.getElementById("k4"),n=document.getElementById("not"),canstartgame=!0,document.getElementById("game").focus()}function isOdd(e){return e%2}function switchPalette(e){if(1==e&&hiscore<3)palettename="⚿ (Beat level 3 to unlock)";else if(2==e&&hiscore<5)palettename="⚿ (Beat level 5 to unlock)";else if(3==e&&hiscore<10)palettename="⚿ (Beat level 10 to unlock)";else if(4==e&&hiscore<15)palettename="⚿ (Reach 15 flips in Endless mode)";else if(5!=e||document.monetization&&"started"===document.monetization.state)if(6!=e||document.monetization&&"started"===document.monetization.state){switch(palette){case 0:c[0]="#223e32",c[1]="#A7C06D",c[2]="#b3dd52",c[3]="#015d00",c[4]="#04bf00",c[5]="#ffffff",palettename="Default Colors";break;case 1:c[0]="#A5836A",c[1]="#FD3633",c[2]="#D33826",c[3]="#E8BD32",c[4]="#668D2E",c[5]="#ffffff",palettename="Strawberry Patch";break;case 2:c[0]="#22393F",c[1]="#00B8B5",c[2]="#50DADC",c[3]="#0087BD",c[4]="#14A9FF",c[5]="#ffffff",palettename="Blueberry Juice";break;case 3:c[0]="#71009F",c[1]="#FE9BCC",c[2]="#FEAED6",c[3]="#AF00F5",c[4]="#ffffff",c[5]="#000000",palettename="Bright & Light";break;case 4:c[0]="#dddddd",c[1]="#222222",c[2]="#444444",c[3]="#bbbbbb",c[4]="#888888",c[5]="#ffffff",palettename="Stylish Monochrome";break;case 5:c[0]="#0F5FA4",c[1]="#9CC6EC",c[2]="#BBD6E7",c[3]="#4087C9",c[4]="#ffffff",c[5]="#000000",palettename="Coil Exclusive: Beau Blueprint";break;case 6:c[0]="#FE875C",c[1]="#8A320A",c[2]="#522313",c[3]="#955857",c[4]="#F7FF57",c[5]="#444444",palettename="Coil Exclusive: Dawnbreak"}1==flipped?(bgcolor=c[0],border.color=c[1],flipline.color=c[1]):(bgcolor=c[1],border.color=c[0],flipline.color=c[0]);for(var t=0;t!=obstacle.length;t++)25==obstacle[t].translate.z?obstacle[t].color=c[2]:obstacle[t].color=c[3];for(t=0;t!=dots.length;t++)dots[t].color=c[4];head.color=c[4],legs.color=c[4],eyes.color=c[5],trail.color=c[5]+"44"}else palettename="⚿ (Exclusive for Coil subscribers)";else palettename="⚿ (Exclusive for Coil subscribers)"}function setCookie(e,t){localStorage.setItem(e,t)}function getCookie(e){var t=localStorage.getItem(e);return null==t?"noone":parseInt(t)}function checkCookie(){var e=getCookie("backflipped_level");"noone"!=e?(hiscore=e,level=Math.min(11,hiscore+1)):setCookie("backflipped_level",0)}gestureZone.addEventListener("touchstart",function(e){touchstartX=e.changedTouches[0].screenX,touchstartY=e.changedTouches[0].screenY},!1),gestureZone.addEventListener("touchend",function(e){touchendX=e.changedTouches[0].screenX,touchendY=e.changedTouches[0].screenY,handleGesture(e)},!1),window.addEventListener("resize",function(){resizeScreen()}),document.addEventListener("visibilitychange",function(){pause(!0)});</script>
    <p class="title top" id="l1">Back</p><p class="title bottom" id="l2">Flipped</p><p class="title start" id="l3">Press Space or Tap Screen</p><p class="int remaining" id="i1">Time: ?</p><p class="int jackpot" id="i2">+? sec</p><p class="int score" id="i3">Flips: ?</p>  <div id="d" class="levelselect"><div class="lvl label" id="d1">Level:</div><span class="lvl arrowleft" id="d3">←&nbsp;</span><b><span class="lvl number" id="d2">1</span></b><span class="lvl arrowright" id="d4">&nbsp;→</span>  </div>  <div id="k" class="colorselect"><div class="clr label" id="k1">Color Pallete:</div><div class="clr arrowup" id="k3">↑</div><b><div class="clr number" id="k2">Default colors</div></b><div class="clr arrowdown" id="k4">↓</div>  </div><p class = "debug">  To do:<br>  - Cram in 13kb<br>  - Music<br>  - Screenshots (160x & 400x250)<br>  <b>Deadline 13 September!</b></p>  <div class="notification" id="not">Game by <b>Tom Hermans (@Auroriax)</b><br><br><b>How to play (Keyboard/Swipe):</b><br>🡸 Left 🡺 Right: Kick<br>🡹 Up: Jump<br>🡻 Down: Rush <br>Touched platforms move to<br>background and increase jackpot.<br>Reach bottom of level to claim<br>jackpot and <b>flip to the backside!</b><br>You lose when time runs out...  </div>  <div class="stats"><div id="fps-display">N/A FPS</div> </div>  </body></html>